# -*- coding: utf-8 -*-
import time

from loguru import logger

from get_regions_tree import get_regions_tree
from keys import OAuth
from regions import get_wordstat_by_regions
from regions_utils import pretty_regions


def main():
    """
    –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º.

    –†–∞–±–æ—Ç–∞ —Å–∫—Ä–∏–ø—Ç–∞:
        1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ä–µ–≥–∏–æ–Ω–æ–≤ —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ get_regions_tree().
        2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ keywords:
            - –ü–æ–ª—É—á–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º —á–µ—Ä–µ–∑ API –Ø–Ω–¥–µ–∫—Å.–í–æ—Ä–¥—Å—Ç–∞—Ç
              —Å –ø–æ–º–æ—â—å—é get_wordstat_by_regions().
            - –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∏ –≤—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å –ø–æ–º–æ—â—å—é pretty_regions().
        3. –î–µ–ª–∞–µ—Ç –ø–∞—É–∑—É –≤ 1 —Å–µ–∫—É–Ω–¥—É –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ª–∏–º–∏—Ç–æ–≤ API.

    –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
        - –°–ø–∏—Å–æ–∫ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ keywords –∑–∞–¥–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ main().
        - OAuth-—Ç–æ–∫–µ–Ω –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ API –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∏–∑ keys.py.

    –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
        - –í—ã–≤–æ–¥–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–º –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º–æ–º –∫–ª—é—á–µ–≤–æ–º —Å–ª–æ–≤–µ.
        - –û—à–∏–±–∫–∏ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤—ã–≤–æ–¥—è—Ç—Å—è —á–µ—Ä–µ–∑ print() –∏ loguru.

    –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
        - –ü–∞—É–∑–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤ 1 —Å–µ–∫—É–Ω–¥—É, –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
          –æ—Ç –ª–∏–º–∏—Ç–æ–≤ API.
        - –§—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–º —Ç–∏–ø–æ–º "cities" –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.

    –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
        –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞:
            python main.py
        –†–µ–∑—É–ª—å—Ç–∞—Ç:
            –í—ã–≤–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞
            –≤ —á–∏—Ç–∞–µ–º–æ–º —Ñ–æ—Ä–º–∞—Ç–µ —Å —Ç–æ–ø-10 —Ä–µ–≥–∏–æ–Ω–æ–≤.
    """
    region_names = get_regions_tree(OAuth=OAuth)
    keywords = ["–º–∞—Ä–∫–µ—Ç–∏–Ω–≥", "–æ–±—É—á–µ–Ω–∏–µ", "–∫—É—Ä—Å—ã"]
    for keyword in keywords:
        logger.info(f"üîç –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ: {keyword}")
        data = get_wordstat_by_regions(keyword, OAuth, "cities")
        if data:
            print(pretty_regions(keyword, data, region_names))
        else:
            print(f"‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è '{keyword}'")
        time.sleep(1)  # —á—Ç–æ–±—ã –Ω–µ –ø—Ä–µ–≤—ã—Å–∏—Ç—å –ª–∏–º–∏—Ç—ã


if __name__ == "__main__":
    main()
